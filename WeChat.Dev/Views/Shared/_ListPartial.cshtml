@using WeChat.Dev.Models;

@{
    var navModel = new NavModel
    {
        ClassList = new List<string> { "weui-form-preview__ft", "fixed_b" },
        Menus = new List<Menu> {
            new Menu{
                Name ="待办",
                ClassList=new List<string>{ "weui-form-preview__btn", "weui-form-preview__btn_default" },
                ButtonType = ButtonType.Link,
                Url = "/app/todos"
            },
            new Menu{
                Name ="已办",
                ClassList=new List<string>{ "weui-form-preview__btn", "weui-form-preview__btn_default" },
                ButtonType = ButtonType.Button,
                Url = "/app/todos",
                CodeSnippet = "onclick=$app.showDoneMenu()"
            },
            new Menu{
                Name ="抄送",
                ClassList=new List<string>{ "weui-form-preview__btn", "weui-form-preview__btn_default" },
                ButtonType = ButtonType.Link,
                Url = "/app/ccnotation"
            }
        }
    };
}
<div class="warpper">
    <div class="page-content" id="@ViewBag.DOMID"></div>
    @Html.Partial("_NavPartial", navModel)
</div>
<script type="text/html" id="tpl_listtemplate">
    <!--listCategory 0待办 1发起 2已办 3抄送-->
    {{each items}}
    <div class="weui-panel">
        <div class="weui-panel__hd">
            <div class="weui-flex">
                <div class="weui-flex__item">
                    {{if (listCategory === 0 || listCategory === 2|| listCategory === 3)}}
                    <!--未读小红点-->
                    {{if $value.ActivationTime == "0003-01-01 00:00"}}
                    <span class="weui-badge">New</span>
                    {{/if}}
                    {{/if}}
                    <!--业务类型-->
                    [{{$value.BizTypeName}}]
                </div>
                <div class="weui-flex__item text-right">
                    <!--处理类型 待办和抄送-->
                    {{if (listCategory === 0 || listCategory === 3)}}
                    <span class="weui-badge bg-success">{{$value.PorcessType}}</span>
                    {{/if}}
                    <!--流程状态 发起和已办-->
                    {{if (listCategory === 1 || listCategory === 2)}}
                    <span class="weui-badge
                              {{if $value.FlowStatus=="0"}}bg-info{{/if}}
                              {{if $value.FlowStatus=="-1"}}bg-danger{{/if}}
                              {{if $value.FlowStatus=="1"}}bg-success{{/if}}">
                        {{$value.FlowStatusName}}
                    </span>
                    {{/if}}
                    {{if $value.UrgencyLevel == 1 }}
                    <span class="weui-badge">紧急</span>
                    {{/if}}
                    {{if $value.TimeoutHour > 0 }}
                    <span class="weui-badge">超时</span>
                    {{/if}}
                    {{if $value.IsExistAttachment}}
                    <i class="iconfont icon-attachment text-golden"></i>
                    {{/if}}
                </div>
            </div>
        </div>
        <div class="weui-panel__bd weui-cell_access">
            <a href="/home/detail" class="weui-media-box weui-media-box_text" mask="true">
                <h4 class="weui-media-box__title">{{$value.Title}}</h4>
                <p class="weui-media-box__desc">
                    当前步骤:{{$value.StepName}}{{if listCategory!==1}}-<span>[{{$value.PorcessType}}]</span>{{/if}}
                </p>
                <ul class="weui-media-box__info">
                    <li class="weui-media-box__info__meta">发起人:{{$value.Initiator}}</li>
                    <li class="weui-media-box__info__meta">
                        <time class="datetime" datetime="{{$value.StartTime}}">{{$value.StartTime}}</time>
                    </li>
                </ul>
            </a>
        </div>
    </div>
    {{/each}}
</script>
